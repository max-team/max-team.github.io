<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>编译配置 | Mars</title>
    <meta name="description" content="Vue 驱动的多端开发框架">
    <link rel="icon" href="/mars/assets/img/Mars-128.png">
    
    <link rel="preload" href="/mars/assets/css/0.styles.86bdb334.css" as="style"><link rel="preload" href="/mars/assets/js/app.4f5b3f70.js" as="script"><link rel="preload" href="/mars/assets/js/10.8bdd3af5.js" as="script"><link rel="prefetch" href="/mars/assets/js/11.b276c24e.js"><link rel="prefetch" href="/mars/assets/js/12.74177023.js"><link rel="prefetch" href="/mars/assets/js/13.2a44d5bc.js"><link rel="prefetch" href="/mars/assets/js/14.09a5ce1c.js"><link rel="prefetch" href="/mars/assets/js/2.3d04bf1d.js"><link rel="prefetch" href="/mars/assets/js/3.b5a81b9e.js"><link rel="prefetch" href="/mars/assets/js/4.cb09f35a.js"><link rel="prefetch" href="/mars/assets/js/5.d50a3654.js"><link rel="prefetch" href="/mars/assets/js/6.d204a649.js"><link rel="prefetch" href="/mars/assets/js/7.dd131531.js"><link rel="prefetch" href="/mars/assets/js/8.319c9b93.js"><link rel="prefetch" href="/mars/assets/js/9.c313d32a.js">
    <link rel="stylesheet" href="/mars/assets/css/0.styles.86bdb334.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/mars/" class="home-link router-link-active"><!----> <span class="site-name">Mars</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/mars/guide/start.html" class="nav-link">教程</a></div><div class="nav-item"><a href="/mars/CHANGELOG.html" class="nav-link">CHANGELOG</a></div><div class="nav-item"><a href="https://github.com/max-team/Mars" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/mars/guide/start.html" class="nav-link">教程</a></div><div class="nav-item"><a href="/mars/CHANGELOG.html" class="nav-link">CHANGELOG</a></div><div class="nav-item"><a href="https://github.com/max-team/Mars" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/mars/guide/start.html" class="sidebar-link">快速开始</a></li><li><a href="/mars/guide/miniprogram.html" class="sidebar-link">框架</a></li><li><a href="/mars/guide/vue-features.html" class="sidebar-link">Vue 特性</a></li><li><a href="/mars/guide/platforms.html" class="sidebar-link">多端适配</a></li><li><a href="/mars/guide/component.html" class="sidebar-link">组件</a></li><li><a href="/mars/guide/API.html" class="sidebar-link">API</a></li><li><a href="/mars/guide/config.html" class="active sidebar-link">编译配置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mars/guide/config.html#配置项" class="sidebar-link">配置项</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/mars/guide/config.html#projectfiles" class="sidebar-link">projectFiles</a></li><li class="sidebar-sub-header"><a href="/mars/guide/config.html#source" class="sidebar-link">source</a></li><li class="sidebar-sub-header"><a href="/mars/guide/config.html#dest" class="sidebar-link">dest</a></li><li class="sidebar-sub-header"><a href="/mars/guide/config.html#assets" class="sidebar-link">assets</a></li><li class="sidebar-sub-header"><a href="/mars/guide/config.html#watch" class="sidebar-link">watch</a></li><li class="sidebar-sub-header"><a href="/mars/guide/config.html#designwidth" class="sidebar-link">designWidth</a></li><li class="sidebar-sub-header"><a href="/mars/guide/config.html#module" class="sidebar-link">module</a></li><li class="sidebar-sub-header"><a href="/mars/guide/config.html#preprocessors" class="sidebar-link">preprocessors</a></li><li class="sidebar-sub-header"><a href="/mars/guide/config.html#postprocessors" class="sidebar-link">postprocessors</a></li><li class="sidebar-sub-header"><a href="/mars/guide/config.html#h5" class="sidebar-link">h5</a></li></ul></li><li class="sidebar-sub-header"><a href="/mars/guide/config.html#默认配置" class="sidebar-link">默认配置</a></li><li class="sidebar-sub-header"><a href="/mars/guide/config.html#配置示例" class="sidebar-link">配置示例</a></li></ul></li><li><a href="/mars/guide/examples.html" class="sidebar-link">案例</a></li><li><a href="/mars/CHANGELOG.html" class="sidebar-link">CHANGELOG</a></li></ul> </div> <div class="page"> <div class="content"><h1 id="编译配置"><a href="#编译配置" aria-hidden="true" class="header-anchor">#</a> 编译配置</h1> <p>项目根目录下的 <code>mars.config.js</code> 为编译配置文件。</p> <p>框架预置的默认配置如下，在 <code>mars.config.js</code> 中的配置会与默认配置进行深度 merge (默认配置中同名的配置项会被自定义配置覆盖，包括数组，数组不会进行 concat，如需要请自行处理)。</p> <p>自定义配置导出类型如下：</p> <p>Type：<code>(target: string) =&gt; Object</code></p> <h2 id="配置项"><a href="#配置项" aria-hidden="true" class="header-anchor">#</a> 配置项</h2> <h3 id="projectfiles"><a href="#projectfiles" aria-hidden="true" class="header-anchor">#</a> <code>projectFiles</code></h3> <p>小程序配置文件列表，每次编译时时不会从 <code>dest</code> 删除</p> <h3 id="source"><a href="#source" aria-hidden="true" class="header-anchor">#</a> <code>source</code></h3> <p>需要编译的单文件组件(SFC)源代码文件 glob</p> <h3 id="dest"><a href="#dest" aria-hidden="true" class="header-anchor">#</a> <code>dest</code></h3> <p>编译产出目录</p> <h3 id="assets"><a href="#assets" aria-hidden="true" class="header-anchor">#</a> <code>assets</code></h3> <p>需要复制到 <code>dest</code> 的文件 glob</p> <h3 id="watch"><a href="#watch" aria-hidden="true" class="header-anchor">#</a> <code>watch</code></h3> <p>需要监听的文件 glob</p> <h3 id="designwidth"><a href="#designwidth" aria-hidden="true" class="header-anchor">#</a> <code>designWidth</code></h3> <p>设计稿尺寸换算单位(px)。</p> <p>框架默认开启 px 单位转换功能（通过 <code>postcss-px2units</code> 插件），在小程序中会转换为 <code>rpx</code>，在 H5 中会转换为 <code>rem</code> （规定 1rem = 100px）。</p> <p>将 <code>designWidth</code> 设置为实际设计稿的宽度值，在开发汇总书写尺寸即可按照 1:1 的关系来进行书写，即从设计稿上量的长度 100px，那么尺寸书写就是 100px。</p> <h3 id="module"><a href="#module" aria-hidden="true" class="header-anchor">#</a> <code>module</code></h3> <p>各个编译模块的配置。</p> <h4 id="module-postcss-px2units"><a href="#module-postcss-px2units" aria-hidden="true" class="header-anchor">#</a> <code>module.postcss.px2units</code></h4> <p>Type: <code>options: Object | false</code></p> <p><code>postcss-px2units</code> 插件配置，如果需要关闭 px 单位转换，将 <code>module.postcss.px2units</code> 设置为 <code>false</code> 即可。
options 配置请参考 <a href="https://www.npmjs.com/package/postcss-px2units" target="_blank" rel="noopener noreferrer">postcss-px2units<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <h3 id="preprocessors"><a href="#preprocessors" aria-hidden="true" class="header-anchor">#</a> <code>preprocessors</code></h3> <p>Type: <code>{[name: string]: processor}</code></p> <p>Type of <code>processor</code>: <code>{ extnames: Array&lt;lang&gt; [, options: Object, process: process]}</code></p> <p>Type of <code>process</code>: <code>(source: string, options: Object) =&gt; string</code></p> <p>预处理器，可以为 SFC 中各种语言类型的 block 设置预处理器（其语言类型由 <code>lang</code> 属性指定），预处理器将在 SFC 每一个 <code>block</code> 编译之前调用。</p> <p>调用内置处理器可以通过 <code>name</code> 来指定要调用的处理器名称，通过 <code>extnames</code> 来设置处理器生效的语言类型，通过 <code>processor.options</code> 来设置传给处理器的选项。</p> <p>目前提供的内置处理器有</p> <ul><li><code>babel</code> 即 <code>@babel/core</code></li> <li><code>less</code></li> <li><code>stylus</code></li> <li><code>scss</code></li> <li><code>postcss</code></li> <li><code>typescript</code></li></ul> <p>如果内置处理器不能满足需求，也可以通过 <code>processor.process</code> 来设置自定义处理器。</p> <h3 id="postprocessors"><a href="#postprocessors" aria-hidden="true" class="header-anchor">#</a> <code>postprocessors</code></h3> <p>后处理器，配置同 <code>preprocessors</code>。后处理器将在 SFC 每一个 <code>block</code> 编译之后调用。</p> <h3 id="h5"><a href="#h5" aria-hidden="true" class="header-anchor">#</a> <code>h5</code></h3> <p>H5 特有编译配置，只影响 H5 的功能。</p> <h4 id="h5-navigationbarhomecolor"><a href="#h5-navigationbarhomecolor" aria-hidden="true" class="header-anchor">#</a> <code>h5.navigationBarHomeColor</code></h4> <p>Type: enum('dark', 'light')</p> <p>Home icon 颜色配置，默认 <code>dark</code>。</p> <h4 id="h5-shownavigationborder"><a href="#h5-shownavigationborder" aria-hidden="true" class="header-anchor">#</a> <code>h5.showNavigationBorder</code></h4> <p>Type: boolean</p> <p>是否显示 navigationBar 下划线，默认true。</p> <h4 id="h5-mode"><a href="#h5-mode" aria-hidden="true" class="header-anchor">#</a> <code>h5.mode</code></h4> <p>Type: enum('history', 'hash')</p> <p>设置 vue-router 的 mode，默认 <code>history</code>。</p> <h2 id="默认配置"><a href="#默认配置" aria-hidden="true" class="header-anchor">#</a> 默认配置</h2> <div class="language-js extra-class"><pre class="language-js"><code>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
        projectFiles<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'project.swan.json'</span><span class="token punctuation">,</span> <span class="token string">'project.config.json'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        source<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'src/**/*.vue'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        dest<span class="token punctuation">:</span> target <span class="token operator">===</span> <span class="token string">'h5'</span> <span class="token operator">?</span> <span class="token string">'./dist-h5/src'</span> <span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`./dist-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>target<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">,</span>
        assets<span class="token punctuation">:</span> <span class="token punctuation">[</span>
            <span class="token string">'src/**/*.!(vue)'</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        designWidth<span class="token punctuation">:</span> <span class="token number">750</span><span class="token punctuation">,</span>
        watch<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'src/**/*'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        modules<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            postcss<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                px2units<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        preprocessors<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            less<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                extnames<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'less'</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            sass<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                extnames<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'sass'</span><span class="token punctuation">,</span> <span class="token string">'scss'</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            stylus<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                extnames<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'stylus'</span><span class="token punctuation">,</span> <span class="token string">'styl'</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            typescript<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                extnames<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'ts'</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        postprocessors<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            postcss<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                extnames<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'less'</span><span class="token punctuation">,</span> <span class="token string">'sass'</span><span class="token punctuation">,</span> <span class="token string">'scss'</span><span class="token punctuation">,</span> <span class="token string">'stylus'</span><span class="token punctuation">,</span> <span class="token string">'styl'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'autoprefixer'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> config<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="配置示例"><a href="#配置示例" aria-hidden="true" class="header-anchor">#</a> 配置示例</h2> <div class="language-js extra-class"><pre class="language-js"><code>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
        designWidth<span class="token punctuation">:</span> <span class="token number">640</span><span class="token punctuation">,</span>
        modules<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            postcss<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                px2units<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    <span class="token comment">// px2units options</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        postprocessors<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            postcss<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                extnames<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'less'</span><span class="token punctuation">,</span> <span class="token string">'sass'</span><span class="token punctuation">,</span> <span class="token string">'scss'</span><span class="token punctuation">,</span> <span class="token string">'stylus'</span><span class="token punctuation">,</span> <span class="token string">'styl'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                    plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'autoprefixer'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> config<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/mars/guide/API.html" class="prev">
          API
        </a></span> <span class="next"><a href="/mars/guide/examples.html">
          案例
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/mars/assets/js/app.4f5b3f70.js" defer></script><script src="/mars/assets/js/10.8bdd3af5.js" defer></script>
  </body>
</html>
